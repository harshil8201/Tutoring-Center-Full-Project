<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta name="author" content="Untree.co" />
    <link rel="shortcut icon" href="favicon.png" />

    <meta name="description" content="" />
    <meta name="keywords" content="bootstrap, bootstrap4" />

    <!-- Bootstrap CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet" />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
      rel="stylesheet"
    />
    <link href="css/tiny-slider.css" rel="stylesheet" />
    <link href="css/style.css" rel="stylesheet" />
    <style>
      .notification {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background-color: #333;
        color: #fff;
        padding: 10px 20px;
        border-radius: 5px;
        display: none;
      }
    </style>
    <title>ProgLearn Hub</title>
  </head>

  <body>
    <!-- Start Header/Navigation -->
    <nav
      class="custom-navbar navbar navbar navbar-expand-md navbar-dark bg-dark"
      arial-label="Furni navigation bar"
    >
      <div class="container">
        <a class="navbar-brand" href="index.html"
          >ProgLearn Hub<span>.</span></a
        >

        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarsFurni"
          aria-controls="navbarsFurni"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarsFurni">
          <ul class="custom-navbar-nav navbar-nav ms-auto mb-2 mb-md-0">
            <li class="nav-item">
              <a class="nav-link" href="index.html">Home</a>
            </li>
            <li class="active">
              <a class="nav-link" href="shop.html">Shop</a>
            </li>
            <li><a class="nav-link" href="about.html">About us</a></li>
            <li><a class="nav-link" href="services.html">Services</a></li>
            <li><a class="nav-link" href="blog.html">Blog</a></li>
            <li><a class="nav-link" href="contact.html">Contact us</a></li>
            <li><a class="nav-link" href="orders.html">Orders</a></li>
            <li><a class="nav-link" href="login.html">Login</a></li>
          </ul>

          <ul class="custom-navbar-cta navbar-nav mb-2 mb-md-0 ms-5">
            <li>
              <a class="nav-link" href="cart.html"
                ><img src="images/cart.svg"
              /></a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <!-- End Header/Navigation -->

    <!-- Start Hero Section -->
    <div class="hero">
      <div class="container">
        <div class="row justify-content-between">
          <div class="col-lg-5">
            <div class="intro-excerpt">
              <h1>Shop</h1>
              <p class="mb-4">
                Explore ProgLearn's diverse array of courses, meticulously
                crafted to cater to every learner's needs and interests. From
                programming to Technology, our comprehensive services offer
                something for everyone, empowering individuals worldwide to
                pursue their passions and achieve their goals.
              </p>
              <p>
                <a href="" class="btn btn-secondary me-2">Shop Now</a
                ><a href="#" class="btn btn-white-outline">Explore</a>
              </p>
            </div>
          </div>
          <div class="col-lg-7">
            <div class="hero-img-wrap">
              <img
                src="https://cdni.iconscout.com/illustration/premium/thumb/mobile-shopping-8770634-7139078.png"
                class="img-fluid"
                style="height: 550px; width: 550px; object-fit: scale-down"
              />
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- End Hero Section -->

    <div class="product-section">
      <div class="container">
        <div class="container">
          <div class="row">
            <div class="col-md-6 mb-4">
              <input
                type="text"
                id="search-input"
                class="form-control"
                placeholder="Search products..."
              />
            </div>
          </div>
        </div>

        <div class="row" id="product-list"></div>
      </div>
    </div>

    <!-- Start Footer Section -->
    <footer class="footer-section">
      <div class="container relative">
        <div class="sofa-img">
          <img
            src="images/Pic1.png"
            alt="Image"
            class="img-fluid"
            style="border-radius: 15%"
          />
        </div>

        <div class="row">
          <div class="col-lg-8">
            <div class="subscription-form">
              <h3 class="d-flex align-items-center">
                <span class="me-1"
                  ><img
                    src="images/envelope-outline.svg"
                    alt="Image"
                    class="img-fluid" /></span
                ><span>Subscribe to Newsletter</span>
              </h3>

              <form action="#" class="row g-3">
                <div class="col-auto">
                  <input
                    type="text"
                    class="form-control"
                    placeholder="Enter your name"
                  />
                </div>
                <div class="col-auto">
                  <input
                    type="email"
                    class="form-control"
                    placeholder="Enter your email"
                  />
                </div>
                <div class="col-auto">
                  <button class="btn btn-primary">
                    <span class="fa fa-paper-plane"></span>
                  </button>
                </div>
              </form>
            </div>
          </div>
        </div>

        <div class="row g-5 mb-5">
          <div class="col-lg-4">
            <div class="mb-4 footer-logo-wrap">
              <a href="#" class="footer-logo">ProgLearn Hub<span>.</span></a>
            </div>
            <p class="mb-4">
              ProgLearn Hub empowers aspiring developers to master programming
              languages, collaborate on projects, and succeed in tech careers.
              With expert-led courses, personalized learning paths, and a
              vibrant community, we help learners thrive in the dynamic world of
              technology.
            </p>

            <ul class="list-unstyled custom-social">
              <li>
                <a href="#"><span class="fa fa-brands fa-facebook-f"></span></a>
              </li>
              <li>
                <a href="#"><span class="fa fa-brands fa-twitter"></span></a>
              </li>
              <li>
                <a href="#"><span class="fa fa-brands fa-instagram"></span></a>
              </li>
              <li>
                <a href="#"><span class="fa fa-brands fa-linkedin"></span></a>
              </li>
            </ul>
          </div>

          <div class="col-lg-8">
            <div class="row links-wrap">
              <div class="col-6 col-sm-6 col-md-3">
                <ul class="list-unstyled">
                  <li><a href="#">About us</a></li>
                  <li><a href="#">Services</a></li>
                  <li><a href="#">Blog</a></li>
                  <li><a href="#">Contact us</a></li>
                </ul>
              </div>

              <div class="col-6 col-sm-6 col-md-3">
                <ul class="list-unstyled">
                  <li><a href="#">Support</a></li>
                  <li><a href="#">Knowledge base</a></li>
                  <li><a href="#">Live chat</a></li>
                </ul>
              </div>

              <div class="col-6 col-sm-6 col-md-3">
                <ul class="list-unstyled">
                  <li><a href="#">Jobs</a></li>
                  <li><a href="#">Our team</a></li>
                  <li><a href="#">Leadership</a></li>
                  <li><a href="#">Privacy Policy</a></li>
                </ul>
              </div>

              <div class="col-6 col-sm-6 col-md-3">
                <ul class="list-unstyled">
                  <li><a href="#">Nordic Chair</a></li>
                  <li><a href="#">Kruzo Aero</a></li>
                  <li><a href="#">Ergonomic Chair</a></li>
                </ul>
              </div>
            </div>
          </div>
        </div>

        <div class="border-top copyright">
          <div class="row pt-4">
            <div class="col-lg-6">
              <p class="mb-2 text-center text-lg-start">
                Copyright &copy;
                <script>
                  document.write(new Date().getFullYear());
                </script>
                . All Rights Reserved. &mdash; Designed with love by
                <a href="#">Lambton</a>
              </p>
            </div>

            <div class="col-lg-6 text-center text-lg-end">
              <ul class="list-unstyled d-inline-flex ms-auto">
                <li class="me-4"><a href="#">Terms &amp; Conditions</a></li>
                <li><a href="#">Privacy Policy</a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </footer>
    <!-- End Footer Section -->
    <div id="notification" class="notification"></div>

    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="js/tiny-slider.js"></script>
    <script src="js/custom.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  </body>
  <script>
    $(document).ready(function () {
      let products = []; // Declare globally accessible products array

      // Function to fetch product data from the API
      async function fetchProducts() {
        try {
          // Check if userEmail is stored in local storage
          const email = localStorage.getItem("userEmail");

          // Construct the URL based on whether the user is logged in
          const apiUrl = email
            ? `http://localhost:5001/api/courses/getCourse?email=${encodeURIComponent(
                email
              )}`
            : `http://localhost:5001/api/courses/getCourse`;

          // Fetch products
          const response = await fetch(apiUrl);

          // Check if the response status is not OK
          if (!response.ok) {
            throw new Error(
              `Network response was not ok. Status: ${response.status}`
            );
          }

          // Parse the response data as JSON
          products = await response.json();

          // Call the populateProductList function to populate the product list with fetched products
          populateProductList(products);
        } catch (error) {
          console.error("Error fetching products:", error);
        }
      }

      // Function to populate the product list div
      function populateProductList(productsToDisplay) {
        var productListDiv = $("#product-list");
        // Empty the div before populating it with new data
        productListDiv.empty();

        // Loop through the products array and generate HTML for each product
        productsToDisplay.forEach(function (product) {
          var productHTML =
            "<div class='col-12 col-md-2 col-lg-2 my-5 mb-0'>" +
            "<a class='product-item' data-_id='" +
            product._id +
            "'  data-name='" +
            product.name +
            "' data-price='" +
            product.price.toFixed(2) +
            "' data-img='" +
            product.img +
            "'>" +
            "<img src='" +
            product.img +
            "' class='img-fluid product-thumbnail' style='width: 100px; height: 100px; object-fit: scale-down;'>" +
            "<h3 class='product-title'>" +
            product.name +
            "</h3>" +
            "<strong class='product-price'>$" +
            product.price.toFixed(2) +
            "</strong>" +
            "<span class='icon-cross'>" +
            "<img src='images/cross.svg' class='img-fluid'>" +
            "</span>" +
            "</a>" +
            "</div>";

          // Append the product HTML to the product list div
          productListDiv.append(productHTML);
        });
      }

      // Fetch products from the API
      fetchProducts();

      // Function to show notification when a product is added to the cart
      function showNotification(message) {
        var notificationDiv = $("#notification");
        notificationDiv.text(message);
        notificationDiv.fadeIn().delay(2000).fadeOut();
      }

      // Function to check if the product is already in the cart
      function isProductInCart(productId) {
        var productList = JSON.parse(localStorage.getItem("productList")) || [];
        return productList.some(function (product) {
          return String(product.id) === String(productId);
        });
      }

      // Event listener for clicking on product-item
      $(document).on("click", ".product-item", function (e) {
        e.preventDefault();
        var productId = $(this).data("_id");
        var productName = $(this).data("name");

        // Check if the product is already in the cart
        var alreadyInCart = isProductInCart(productId);

        if (alreadyInCart) {
          showNotification(productName + " is already in the cart");
        } else {
          // Add the product to the cart
          var productListcart =
            JSON.parse(localStorage.getItem("productList")) || [];
          productListcart.push({
            id: productId,
            name: $(this).data("name"),
            price: parseFloat($(this).data("price")),
            img: $(this).data("img"),
          });

          // Update the product list in localStorage
          localStorage.setItem("productList", JSON.stringify(productListcart));

          // Show success notification
          showNotification(productName + " added to cart");
        }
      });

      // Search functionality
      $("#search-input").on("keyup", function () {
        var searchTerm = $(this).val().toLowerCase();
        var filteredProducts = products.filter(function (product) {
          return product.name.toLowerCase().includes(searchTerm);
        });
        populateProductList(filteredProducts);
      });
    });
  </script>
</html>
